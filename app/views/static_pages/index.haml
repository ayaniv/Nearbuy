.row
  .col-lg-12
    #map_home_page
      /= gmaps("map_options" => {"libraries" => ["places"], "zoom" => 13, "auto_zoom" => false, id: "map_home_page", "detect_location" => "false"}, "markers" => {"data" => @address.to_gmaps4rails})
      /= gmaps("map_options" => {"zoom" => 13, "detect_location" => "true", "center_on_user" => "true", id: "map_home_page", raw:'{zoomControl: true, streetViewControl: false, mapTypeControl: false,}'}) #"auto_zoom" => false, id: "map_home_page"}, "markers" => {"data" => @address.to_gmaps4rails})
      
    %h1.text-center
      %span A great place to find goods
    
.row
  .col-lg-12.text-center.input_search
    %form#address
      .before#locate_me
      %input.input-block-level#search_box{type:"text", placeholder:"Type Address"}
      .after#find_address
      

.row
  .col-lg-12
    %p.text-center
      %h1{style:"display: none"} Items Around You
    .spinner{style:"display:none"}= image_tag "ajax-loader.gif"

.row
  .col-lg-12
    .items
      = render partial:"items/items", locals:{items: @items}
:coffee
  jQuery ->
    display_map = (position) ->
      mapOptions = {
        zoom: 13
        zoomControl: false,
        disableDefaultUI: true, 
        mapTypeId: google.maps.MapTypeId.ROADMAP
      }
      map = new google.maps.Map(document.getElementById('map_home_page'), mapOptions);
      pos = new google.maps.LatLng(position.latitude, position.longitude);
      infowindow = new google.maps.InfoWindow({
        map: map,
        position: pos,
        content: '<div style="min-width: 150px; min-height: 30px;">Items around me</div>'
      })
      map.setCenter(pos)

    # This methods gets loaded at the start with varaibles from server. 
    # This allows some kind of location based on ip
    put_map = () ->
      # Create a custom position object to display map
      position = {
        latitude: "#{@address.latitude}"
        longitude: "#{@address.longitude}"
      }
      # Finally, display the map
      display_map(position)
      
    # First verions of map to be displayed based on 
    # ip or something we get from server
    put_map()
